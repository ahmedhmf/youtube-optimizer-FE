<div class="mx-auto max-w-7xl">
  <h2 class="text-3xl font-bold tracking-tight mb-8">Dashboard</h2>
  <div class="grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3">
    <div
      class="relative overflow-hidden rounded-lg bg-card-light dark:bg-card-dark border border-border-light dark:border-border-dark shadow-sm"
    >
      <div class="absolute top-0 left-0 h-1.5 w-full gradient-highlight"></div>
      <div class="p-6">
        <p class="text-sm font-medium text-text-secondary-light dark:text-text-secondary-dark">
          Total Analyzed Videos
        </p>
        <p class="mt-1 text-4xl font-bold">1,284</p>
      </div>
    </div>
    <div
      class="relative overflow-hidden rounded-lg bg-card-light dark:bg-card-dark border border-border-light dark:border-border-dark shadow-sm"
    >
      <div class="absolute top-0 left-0 h-1.5 w-full gradient-highlight"></div>
      <div class="p-6">
        <p class="text-sm font-medium text-text-secondary-light dark:text-text-secondary-dark">
          Average Analysis Time
        </p>
        <p class="mt-1 text-4xl font-bold">42s</p>
      </div>
    </div>
    <div
      class="relative overflow-hidden rounded-lg bg-card-light dark:bg-card-dark border border-border-light dark:border-border-dark shadow-sm"
    >
      <div class="absolute top-0 left-0 h-1.5 w-full gradient-highlight"></div>
      <div class="p-6">
        <p class="text-sm font-medium text-text-secondary-light dark:text-text-secondary-dark">
          User Accuracy
        </p>
        <p class="mt-1 text-4xl font-bold">98.7%</p>
      </div>
    </div>
  </div>
  <div class="mt-10">
    <h3 class="text-xl font-semibold">Recent History</h3>
    <div class="mt-4 flow-root">
      <div class="-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
        <div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
          <div
            class="overflow-hidden rounded-lg border border-border-light dark:border-border-dark bg-card-light dark:bg-card-dark"
          >
            <table class="min-w-full divide-y divide-border-light dark:divide-border-dark">
              <thead class="bg-background-light dark:bg-card-dark/50">
                <tr>
                  <th
                    class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-text-light dark:text-text-dark sm:pl-6"
                    scope="col"
                  >
                    Video Title
                  </th>
                  <th
                    class="px-3 py-3.5 text-left text-sm font-semibold text-text-light dark:text-text-dark"
                    scope="col"
                  >
                    Date Analyzed
                  </th>
                  <th
                    class="px-3 py-3.5 text-left text-sm font-semibold text-text-light dark:text-text-dark"
                    scope="col"
                  >
                    Status
                  </th>
                  <th class="relative py-3.5 pl-3 pr-4 sm:pr-6" scope="col">
                    <span class="sr-only">View</span>
                  </th>
                </tr>
              </thead>
              <tbody class="divide-y divide-border-light dark:divide-border-dark">
                @for (job of jobs; track job.id) {
                  <tr>
                    <td
                      class="whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-text-light dark:text-text-dark sm:pl-6"
                    >
                    {{job.data.video_title}}
                    </td>
                    <td
                      class="whitespace-nowrap px-3 py-4 text-sm text-text-secondary-light dark:text-text-secondary-dark"
                    >
                      {{getTimeDifference(job.createdAt)}}
                    </td>
                    <td class="whitespace-nowrap px-3 py-4 text-sm">
                      <span
                        class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium"
                        [class.bg-green-100]="job.status === 'completed'"
                        [class.bg-red-100]="job.status === 'failed'"
                        [class.bg-yellow-100]="job.status === 'processing'"
                        [class.dark:bg-green-900/50]="job.status === 'completed'"
                        [class.dark:bg-red-900/50]="job.status === 'failed'"
                        [class.dark:bg-yellow-900/50]="job.status === 'processing'"
                        [class.dark:text-green-300]="job.status === 'completed'"
                        [class.dark:text-red-300]="job.status === 'failed'"
                        [class.dark:text-yellow-300]="job.status === 'processing'"
                        [class.text-green-800]="job.status === 'completed'"
                        [class.text-red-800]="job.status === 'failed'"
                        [class.text-yellow-800]="job.status === 'processing'"
                        >{{job.status | titlecase }}</span
                      >
                    </td>
                    <td
                      class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"
                    >
                    @if (job.status === 'completed') {
                      <button class="inline-flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-primary hover:text-primary-light bg-primary/10 hover:bg-primary/20 dark:bg-primary/20 dark:hover:bg-primary/30 rounded-md border border-primary/30 dark:border-primary/40 transition-colors"
                        type="button" (click)="viewJobDetails(job.id)">
                        <span class="material-symbols-outlined text-sm">visibility</span>
                        View
                        <span class="sr-only">, {{ job.data.video_title }}</span>
                    </button>
                    } @else if (job.status === 'failed') {
                      <button class="inline-flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-blue-600 hover:text-blue-800 bg-blue-50 hover:bg-blue-100 dark:bg-blue-900/20 dark:text-blue-400 dark:hover:text-blue-300 dark:hover:bg-blue-900/40 rounded-md border border-blue-200 dark:border-blue-800 transition-colors"
                          type="button" (click)="retryJob(job.id)">
                          <span class="material-symbols-outlined text-sm">refresh</span>
                          Retry
                          <span class="sr-only">, {{ job.data.video_title }}</span>
                      </button>
                    }
                    @else {
                      <button class="inline-flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-red-600 hover:text-red-800 bg-red-50 hover:bg-red-100 dark:bg-red-900/20 dark:text-red-400 dark:hover:text-red-300 dark:hover:bg-red-900/40 rounded-md border border-red-200 dark:border-red-800 transition-colors"
                        type = "button" (click)="cancelJob(job.id)">
                        <span class="material-symbols-outlined text-sm">cancel</span>
                        Cancel
                        <span class="sr-only">, {{ job.data.video_title }}</span>
                    </button>
                    }
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
